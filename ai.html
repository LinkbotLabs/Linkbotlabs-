<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AI Playground</title>
<script src="https://js.puter.com/v2/"></script>
<style>
  /* ---------- COLORS ---------- */
  :root {
    --background: #0b0c1a;       /* dark navy */
    --glass: rgba(11,12,26,0.45);
    --stroke: rgba(255,255,255,0.12);
    --text: #ffffff;
    --muted: #7deaff;             /* cyan highlight */
    --accent: #00fff7;            /* primary buttons / highlights */
  }

  /* ---------- GLOBAL ---------- */
  * { box-sizing: border-box; }
  html, body {
    margin:0; padding:24px;
    height:100%;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    color: var(--text);
    background: var(--background);
  }
  h1 { margin:0 0 18px 0; font-weight:700; letter-spacing:.2px; }
  h2 { color: var(--accent); }

  .grid { display:grid; grid-template-columns:repeat(12,1fr); gap:18px; }
  .card {
    grid-column: span 12;
    background: var(--glass);
    border: 1px solid var(--stroke);
    border-radius: 16px;
    padding: 20px;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.6);
  }
  @media (min-width:900px) { #card-chat, #card-stream, #card-image { grid-column: span 6; } }

  label { display:block; font-size:12px; color: var(--muted); margin:8px 0 6px; }
  textarea,input,select {
    width:100%;
    color: var(--text);
    background: rgba(255,255,255,0.05);
    border:1px solid var(--stroke);
    border-radius:12px;
    padding:12px 14px;
    outline:none;
    caret-color: var(--accent);
  }
  textarea { min-height:140px; resize: vertical; }
  button {
    display:inline-flex; align-items:center; gap:8px;
    background: var(--accent);
    color: #000;
    font-weight:700;
    border:0;
    border-radius:12px;
    padding:12px 16px;
    cursor:pointer;
    margin-top:12px;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }
  button:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,255,255,0.4); }
  .output {
    margin-top:14px;
    padding:16px;
    border-radius:12px;
    background: rgba(255,255,255,0.05);
    border:1px solid var(--stroke);
    white-space: pre-wrap;
    word-wrap: break-word;
    min-height:180px;
    overflow-y:auto;
  }
  .hint { font-size:12px; color:var(--muted); margin-top:6px; }
  .avatar { width:32px; height:32px; border-radius:50%; margin-right:8px; }
</style>
</head>
<body>
<h1>AI Playground</h1>
<div class="grid">

  <!-- CHAT / Q&A -->
  <div class="card" id="card-chat">
    <h2>Chat / Q&amp;A</h2>
    <div class="hint">Ask anything. Demo lasts 15 minutes.</div>
    <label for="chat-model">Model</label>
    <select id="chat-model">
      <option value="gpt-4.1-nano" selected>GPT-4.1-nano</option>
      <option value="gpt-4.1">GPT-4.1</option>
      <option value="gpt-4.1-mini">GPT-4.1-mini</option>
      <option value="gpt-4o">GPT-4o</option>
      <option value="gpt-5">GPT-5</option>
      <option value="gpt-5-mini">GPT-5-mini</option>
      <option value="gpt-5-nano">GPT-5-nano</option>
    </select>
    <label for="chat-prompt">Prompt</label>
    <textarea id="chat-prompt" placeholder="Ask me anything..."></textarea>
    <button id="chat-run">Run</button>
    <div class="output" id="chat-out"></div>
  </div>

  <!-- STREAMING LONG RESPONSES -->
  <div class="card" id="card-stream">
    <h2>Streaming Responses</h2>
    <div class="hint">See responses arrive in real-time.</div>
    <label for="stream-model">Model</label>
    <select id="stream-model">
      <option value="gpt-4.1-nano" selected>GPT-4.1-nano</option>
      <option value="gpt-4.1">GPT-4.1</option>
      <option value="gpt-4o">GPT-4o</option>
      <option value="gpt-5-nano">GPT-5-nano</option>
    </select>
    <label for="stream-prompt">Prompt</label>
    <textarea id="stream-prompt">Explain relativity in detail.</textarea>
    <button id="stream-run">Stream</button>
    <div class="output" id="stream-out"></div>
  </div>

  <!-- IMAGE GENERATOR (Pro users only) -->
  <div class="card" id="card-image">
    <h2>Image Generator (Pro)</h2>
    <div class="hint">Only available for donors.</div>
    <label for="image-prompt">Image Prompt</label>
    <textarea id="image-prompt">A fantasy landscape at sunset</textarea>
    <button id="image-run">Generate</button>
    <div class="output" id="image-out"></div>
  </div>

</div>

<script>
/* ---------- HELPERS ---------- */
function putText(el, text){ el.innerHTML = (text ?? '').toString(); }
function appendText(el, text){ el.innerHTML += (text ?? '').toString(); }
function escapeHTML(str){
  return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");
}
function normalizeResp(resp){
  if(!resp) return '';
  if(typeof resp==='string') return resp;
  if(resp.output_text) return resp.output_text;
  if(resp.text) return resp.text;
  if(resp.message?.content) return resp.message.content;
  return JSON.stringify(resp);
}

/* ---------- DEMO TIMER ---------- */
let demoActive = true;
const DEMO_DURATION = 15*60*1000; // 15 min
setTimeout(()=>{ demoActive=false; showDemoOverlay(); }, DEMO_DURATION);
function showDemoOverlay(){
  const overlay = document.createElement('div');
  overlay.style.position='fixed';
  overlay.style.top=0; overlay.style.left=0;
  overlay.style.width='100%';
  overlay.style.height='100%';
  overlay.style.background='rgba(0,0,0,0.85)';
  overlay.style.color='#fff';
  overlay.style.display='flex';
  overlay.style.flexDirection='column';
  overlay.style.justifyContent='center';
  overlay.style.alignItems='center';
  overlay.style.zIndex=9999;
  overlay.innerHTML=`
    <h1>Demo Expired</h1>
    <p>Any donation unlocks unlimited chat & Pro features.</p>
    <a href="https://wise.com/pay/me/davids14542" target="_blank" style="color:#00fff7;font-size:20px;text-decoration:underline;">Donate Here</a>
  `;
  document.body.appendChild(overlay);
}

/* ---------- CHAT ---------- */
async function runChat(model,prompt,out){
  if(!demoActive){ showDemoOverlay(); return; }
  if(!prompt){ putText(out,'Please enter a prompt.'); return; }
  putText(out,'Thinkingâ€¦');
  try{
    const resp = await puter.ai.chat(prompt,{model});
    putText(out,escapeHTML(normalizeResp(resp)).replaceAll('\n','<br>'));
  }catch(e){ putText(out,'Error: '+(e?.message??e)); }
}

/* ---------- STREAMING ---------- */
async function runStream(model,prompt,out){
  if(!demoActive){ showDemoOverlay(); return; }
  if(!prompt){ putText(out,'Please enter a prompt.'); return; }
  putText(out,'');
  try{
    const stream = await puter.ai.chat(prompt,{model,stream:true});
    for await(const part of stream){
      let text=part?.output_text??part?.text??part?.message?.content??'';
      appendText(out,escapeHTML(text).replaceAll('\n','<br>'));
    }
  }catch(e){ putText(out,'Error: '+(e?.message??e)); }
}

/* ---------- IMAGE GENERATOR (PRO) ---------- */
async function runImage(prompt,out){
  if(!demoActive){ showDemoOverlay(); return; }
  putText(out,'Generating...');
  try{
    const resp = await puter.ai.image(prompt,{size:"512x512"}); 
    if(resp?.url) putText(out,'<img src="'+resp.url+'" style="max-width:100%; border-radius:10px;">');
    else putText(out,'No image returned.');
  }catch(e){ putText(out,'Error: '+(e?.message??e)); }
}

/* ---------- EVENTS ---------- */
document.getElementById('chat-run').addEventListener('click',()=>{
  const model=document.getElementById('chat-model').value;
  const prompt=document.getElementById('chat-prompt').value.trim();
  const out=document.getElementById('chat-out');
  runChat(model,prompt,out);
});
document.getElementById('stream-run').addEventListener('click',()=>{
  const model=document.getElementById('stream-model').value;
  const prompt=document.getElementById('stream-prompt').value.trim();
  const out=document.getElementById('stream-out');
  runStream(model,prompt,out);
});
document.getElementById('image-run').addEventListener('click',()=>{
  const prompt=document.getElementById('image-prompt').value.trim();
  const out=document.getElementById('image-out');
  runImage(prompt,out);
});
</script>
</body>
</html>
