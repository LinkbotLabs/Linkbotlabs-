<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LinkBotLabs Products</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 16px;
    background: linear-gradient(180deg, #000, #1a1a1a);
    color: #fff;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  h1 { 
    text-align: center; 
    color: cyan; 
    margin: 10px 0; 
    text-shadow: 0 0 6px rgba(0,255,255,0.6);
  }
  .affiliate-banner {
    background: #0077b6;
    color: #fff;
    padding: 12px;
    text-align: center;
    font-weight: bold;
  }

  #main {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  .top-half, .bottom-half {
    flex: 1;
  }

  /* Horizontal scroll one product at a time */
  .top-half {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }
  .product-card {
    flex: 0 0 100%;
    height: 100%;
    box-sizing: border-box;
    scroll-snap-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background: rgba(20, 20, 20, 0.85);
    border: 1px solid #3a3a5d;
    padding: 20px;
    text-align: center;
    backdrop-filter: blur(8px);
  }
  .product-title { font-size: 28px; font-weight: bold; margin: 10px 0; }
  .product-price { color: cyan; font-weight: bold; font-size: 22px; }
  .product-desc { font-size: 18px; color: #ccc; margin: 15px 0; }
  .product-btn {
    padding: 14px;
    background: linear-gradient(135deg, #00bcd4, #0097a7);
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    width: 80%;
    margin: 0 auto;
    box-shadow: 0 0 10px rgba(0,255,255,0.4);
    transition: 0.2s;
  }
  .product-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px cyan; }

  /* Chat half */
  .bottom-half {
    display: flex;
    flex-direction: row;
    border-top: 2px solid #3a3a5d;
    background: rgba(15, 15, 25, 0.9);
    padding: 12px;
  }
  .chat-box {
    flex: 1;
    border-radius: 10px;
    padding: 14px;
    border: 1px solid #3a3a5d;
    background: #111;
    color: #fff;
    font-family: monospace;
    resize: none;
    font-size: 20px; /* Bigger text */
    line-height: 1.5;
  }
  .chat-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-left: 12px;
  }
  .round-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, #00bcd4, #0097a7);
    color: #fff;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0,255,255,0.5);
    transition: 0.2s;
  }
  .round-btn:hover { transform: scale(1.1); box-shadow: 0 0 20px cyan; }

  /* Socials */
  .socials {
    position: fixed;
    top: 50%;
    left: 10px;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .socials a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: cyan;
    border-radius: 50%;
    color: #0d0d1a;
    font-weight: bold;
    text-decoration: none;
    transition: 0.3s;
  }
  .socials a:hover { background: #9d4edd; color: #fff; }
</style>
</head>
<body>
<div id="affiliate-banner" class="affiliate-banner" style="display:none;"></div>
<h1>‚ú® LinkBotLabs Product Picks ‚ú®</h1>

<div id="main">
  <div class="top-half" id="content"></div>
  <div class="bottom-half">
    <textarea id="globalChat" class="chat-box" placeholder="Type your message..."></textarea>
    <div class="chat-buttons">
      <button id="runGlobal" class="round-btn">‚ñ∂</button>
      <button id="speakGlobal" class="round-btn">üé§</button>
      <button id="clearGlobal" class="round-btn">‚ùå</button>
      <button id="ttsGlobal" class="round-btn">üîä</button>
    </div>
  </div>
</div>

<div class="socials">
  <a href="https://www.tiktok.com/@linkbotlabs" target="_blank">TT</a>
  <a href="https://x.com/davidsh23159401?s=21" target="_blank">X</a>
  <a href="https://youtube.com/@linkbotlabs" target="_blank">YT</a>
  <a href="https://facebook.com/linkbotlabs" target="_blank">FB</a>
</div>

<script src="https://js.puter.com/v2/"></script>
<script>
const content = document.getElementById("content");
let synth = window.speechSynthesis;
let utter;

// Affiliate
function getAffiliateId() {
  const params = new URLSearchParams(window.location.search);
  return params.get("aff_id") || null;
}
const affiliateId = getAffiliateId();
if (affiliateId) {
  const banner = document.getElementById("affiliate-banner");
  banner.textContent = `‚úÖ Affiliate active. Purchases support ID: ${affiliateId}`;
  banner.style.display = "block";
}

// Products
async function loadProducts() {
  try {
    const res = await fetch("products.json?cachebust=" + Date.now());
    const data = await res.json();
    renderProducts(data);
  } catch {
    content.innerHTML = `<p style="color:red;">‚ùå Failed to load products.</p>`;
  }
}
function renderProducts(data) {
  content.innerHTML = "";
  for (const [category, items] of Object.entries(data)) {
    items.forEach(p => {
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <h3 class="product-title">${p.title}</h3>
        <p class="product-price">${p.price}</p>
        <p class="product-desc">${p.description}</p>
        <button class="product-btn">üõí View</button>
      `;
      card.querySelector("button").onclick = () => {
        let link = p.url;
        if (affiliateId) link += (p.url.includes("?") ? "&" : "?") + "tag=" + affiliateId;
        window.open(link, "_blank");
      };
      content.appendChild(card);
    });
  }
}
loadProducts();

// Chat
const chatBox = document.getElementById("globalChat");
document.getElementById("runGlobal").onclick = async () => {
  const userText = chatBox.value.trim();
  if (!userText) return;
  const response = await puter.ai.chat(userText);
  chatBox.value += `\nü§ñ: ${response}`;
  chatBox.scrollTop = chatBox.scrollHeight;
  playTTS(response);
};
document.getElementById("ttsGlobal").onclick = () => playTTS(chatBox.value);
document.getElementById("clearGlobal").onclick = () => chatBox.value = "";
document.getElementById("speakGlobal").onclick = () => alert("üé§ Voice input coming soon!");

// TTS
function playTTS(text) {
  if (synth.speaking) synth.cancel();
  utter = new SpeechSynthesisUtterance(text);
  synth.speak(utter);
}
</script>
</body>
</html>
